# COMP_ENG 493 Project

## Project Repository structure
The repository is structured to group like-files together. Here is a short description of the file folders:
 * [model/](./model): All modelling files, both in C++ and MATLAB.
 * [hdl/](./hdl): All HDL files are stored here, written in Verilog.
 * [test/](./test): All Verilog test bench files.
 * [simulation/](./simulation): Simulation files generated by Cadence Xcelium. Navigate to this file prior to executing any Xcelium commands.
 * [backend/](./backend): Backend files generated during routing with Cadence Innovus. Navigate to this file prior to executing any Innovus commands.

## Verilog Simulation
Each stage of the design processes is simulated to verify results. The main check is performed with the [tb_syn_ml_accelerator.v](./test/tb_syn_ml_accelerator.v) file, which calculates a 3x3 output feature map. There are a few other test benches in the `test/` folder that are not used here, but offer far greater levels of debugging.

To simulate the plain, original HDL code:
```bash
cd simulation
xrun -64bit -access r ../hdl/{pe,gin_bus,gin,multicast_controller,ml_accelerator}.v ../test/tb_syn_ml_accelerator.v | less
```

To simulate the synthesized HDL code:
```bash
cd simulation
xrun -64bit -access r -xmelab_args "-warnmax 0 -delay_mode zero -maxdelays" ../hdl/syn_ml_accelerator.v ../test/tb_syn_ml_accelerator.v /vol/ece303/genus_tutorial/NangateOpenCellLibrary.v | less
```

To simulate the gate-level netlist after backend layout:
```bash
cd simulation
xrun -64bit -access r -xmelab_args "-warnmax 0 -delay_mode zero -maxdelays" ../backend/nophy_ml_accelerator.v ../test/tb_syn_ml_accelerator.v /vol/ece303/genus_tutorial/NangateOpenCellLibrary.v | less
```

## HDL Synthesis
The HDL synthesis is scritable and can easisly be generated by loading the [design_script.g](./synthesis/design_script.g) file. Run the following commands to synthesize optimized HDL:
```bash
cd synthesis
source /vol/ece303/genus_tutorial/cadence.env
genus -f design_script.g
```

## Backend Layout
The backend layout _might_ be scriptable, but I'm not sure. The set of commands used for chip layout are contained in the [design_script.g](./backend/design_script.g) file. Importing this with `cd backend; innovus -file design_script.g` might work. If not, each command can by copy-pasted into the command window.
